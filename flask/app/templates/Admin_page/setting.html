{% extends 'Admin_page/base.html' %} {% block content %}
<div class="container">
  <div class="columns is-vcentered is-justify-content-space-between mt-5">
    <div class="column is-3">
      <h1 class="title">Settings</h1>
    </div>
  </div>

  <!-- Sound Settings -->
  <div class="card rows">
    <div class="card-header">
      <h1 class="card-header-title">Settings Sound</h1>
    </div>
    <div class="card-content">
      <div class="columns is-multiline">
        <!-- Cooking Room Sound -->
        <div class="column is-one-third">
          <div class="box">
            <h2 class="subtitle">Upload Cooking Room Sound</h2>
            <form method="POST" action="/setting" enctype="multipart/form-data">
              <div class="field">
                <label class="label" for="cooking_sound"
                  >Cooking Room Sound (cooking_room.mp3)</label
                >
                <div class="control">
                  <input
                    type="file"
                    class="input"
                    id="cooking_sound"
                    name="cooking_sound"
                    accept="audio/mp3"
                  />
                </div>
              </div>
              <div class="field">
                <div class="control">
                  <button type="submit" class="button is-info">
                    Upload Cooking Sound
                  </button>
                </div>
              </div>
            </form>
          </div>
        </div>

        <!-- Waiter Sound -->
        <div class="column is-one-third">
          <div class="box">
            <h2 class="subtitle">Upload Waiter Sound</h2>
            <form method="POST" action="/setting" enctype="multipart/form-data">
              <div class="field">
                <label class="label" for="waiter_sound"
                  >Waiter Sound (waiter.mp3)</label
                >
                <div class="control">
                  <input
                    type="file"
                    class="input"
                    id="waiter_sound"
                    name="waiter_sound"
                    accept="audio/mp3"
                  />
                </div>
              </div>
              <div class="field">
                <div class="control">
                  <button type="submit" class="button is-info">
                    Upload Waiter Sound
                  </button>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Logo Settings -->
  <div class="card rows">
    <div class="card-header">
      <h1 class="card-header-title">Settings Logo</h1>
    </div>
    <div class="card-content">
      <div class="column is-one-third">
        <div class="box">
          <h2 class="subtitle">Upload Logo</h2>
          <form method="POST" action="/setting" enctype="multipart/form-data">
            <div class="field">
              <label class="label" for="logo_file">Logo (logo.jpg)</label>
              <div class="control">
                <input
                  type="file"
                  class="input"
                  id="logo_file"
                  name="logo_file"
                  accept="image/jpeg"
                />
              </div>
            </div>
            <div class="field">
              <div class="control">
                <button type="submit" class="button is-info">
                  Upload Logo
                </button>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Tax & Service Charge -->
  <div class="card rows">
    <div class="card-header">
      <h1 class="card-header-title">Setting vat</h1>
    </div>
    <div class="card-content">
      <div class="column is-one-third">
        <div class="box">
          <h2 class="subtitle">Setting vat</h2>
          <form method="POST" action="/setting">
            <div class="field">
              <label class="label" for="vat_rate">vat (%)</label>
              <div class="control">
                <input
                  type="number"
                  class="input"
                  id="vat_rate"
                  name="vat_rate"
                  min="0"
                  step="0.01"
                  value="{{ store.vat if store else '' }}"
                />
              </div>
            </div>
            <div class="field">
              <div class="control">
                <button type="submit" class="button is-info">
                  Save Changes
                </button>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Order Settings -->
  <div class="card rows">
    <div class="card-header">
      <h1 class="card-header-title">Order Settings</h1>
    </div>
    <div class="card-content">
      <div class="columns is-multiline">
        <div class="column is-one-third">
          <div class="box">
            <h2 class="subtitle">Max Orders per Round</h2>
            <form method="POST" action="/setting">
              <div class="field">
                <input
                  type="number"
                  class="input"
                  name="max_orders"
                  min="1"
                  value="{{ store.Max_Orders_per_Round if store else '' }}"
                />
              </div>
              <div class="field">
                <button type="submit" class="button is-info">Save</button>
              </div>
            </form>
          </div>
        </div>

        <div class="column is-one-third">
          <div class="box">
            <h2 class="subtitle">Max Food Quantity per Order</h2>
            <form method="POST" action="/setting">
              <div class="field">
                <input
                  type="number"
                  class="input"
                  name="max_food_quantity"
                  min="1"
                  value="{{ store.Max_Food_Quantity_per_Order if store else '' }}"
                />
              </div>
              <div class="field">
                <button type="submit" class="button is-info">Save</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %} {% block extra_js %}
<script>
    // ตรวจสอบว่าแบบฟอร์มถูกส่งแล้ว
    document.querySelectorAll('form').forEach(function(form) {
      form.addEventListener('submit', function(event) {
        event.preventDefault();  // ป้องกันการส่งฟอร์มแบบปกติ
        const formData = new FormData(form);
        
        fetch(form.action, {
          method: 'POST',
          body: formData
        })
        .then(response => response.json())  // หรือใช้ response ตามที่เซิร์ฟเวอร์ส่งกลับมา
        .then(data => {
          // หากสำเร็จให้รีเฟรชหน้า
          window.location.reload();
        })
        .catch(error => console.error('Error:', error));
      });
    });
</script>
{% endblock %}
